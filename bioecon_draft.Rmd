---
title: Heterogeneous land use impacts of Chilean payments for native reforestation
author: "Alberto Garcia and Robert Heilmayr"
date: "May 10, 2021"
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
    number_sections: yes
    toc: no
  html_document: default
  documentclass: article
bibliography: ERE_12March_ref.bib
header-includes: 
  \usepackage{setspace}
  \usepackage{bbm}  
  \usepackage{graphicx}
  \usepackage{amsmath}
  \usepackage{amssymb}
  \usepackage{sectsty}
  \usepackage{float}
  \usepackage{color}
  \usepackage{outlines}
---
\doublespacing
\sectionfont{\fontsize{11}{11}\selectfont}
\subsectionfont{\fontsize{11}{11}\selectfont}

```{r setup, include=FALSE}
library(knitr)
library(ggplot2)
library(kableExtra)
library(tidyverse)
library(stargazer)

source('summarySE.R')

knitr::opts_chunk$set(echo = FALSE, warnings = FALSE, messages = FALSE, out.width="49%", fig.align = "center")
```

# Abstract {-}
Widespread reforestation has become an important part of global efforts to address the intertwined challenges posed by climate change, biodiversity loss, and rural poverty. In response to concerns that plantations of exotic species may undermine objectives of increased carbon storage, biodiversity, and community involvement, some policies have sought to reforest with native species. We evaluate land cover impacts of a Chilean federal program that pays landowners to reforest their property with native species. Panel data for program beneficiaries and comparable unawarded properties allow us to control for fixed differences and time trends affecting both groups. We find that the program increased vegetation cover on the properties of both smallholders and larger landowners. Pre-program land use is a major determinant of additionality, and in particular, landowners with plantation forest on their property saw much higher forest cover gains relative to the counterfactual. In contrast to avoided deforestation, where additionality is driven by deforestation risk, this indicates the importance of prior landowner experience for reforestation success. 

\clearpage

# Introduction

In order to achieve the warming targets set by the IPCC, both emissions reductions and removals of carbon from the atmosphere will be necessary [@bastin_global_2019]. Reforestation has been lauded as a potentially near term, large scale and low-cost option to achieve these carbon removals [@busch_potential_2019], however, there is limited evidence documenting the effectiveness of policies seeking to encourage reforestation at large scales. One policy that is expected to play an important role in helping countries meet their reforestation commitments is a system in which private landowners are paid to engage in reforestation [@gichuki_reviving_2019]. While similar payment for ecosystem services (PES) programs have garnered widespread scientific interest [@borner_effectiveness_2017], empirical studies documenting the impacts of large-scale reforestation programs are critical to guide the effective design of policies as more countries adopt this model. 

Within the natural climate solutions literature, ample attention has been given to the co-benefits and co-risks that can arise from the growing market for carbon removals. As a result of the emphasis on generating biomass, many programs have encouraged afforestation with monocultures of quick-growing exotic species such as eucalyptus and monterrey pine [@iucn_afforestation_2016]. This model can have co-risks such as the conversion of native ecosystems, loss of biodiversity, and exacerbation of distributional issues [@heilmayr_impacts_2020]. On the other hand, many argue that these schemes can avoid the aforementioned risks and generate substantial co-benefits if done properly. These often cited co-benefits include biodiversity conservation, habitat improvement, watershed protection, and support for lower-income and indigenous communities. 

A vast targeting literature aims to enhance cost-effectiveness and environmental gains of PES programs [@alix-garcia_payment_2014]. In many cases, the social planner hopes to generate co-benefits and to target for both environmental and social development goals. @alix-garcia_only_2015 show that an avoided deforestation program generated positive but small gains in forest cover and poverty alleviation. They highlight that environmental gains were mostly in low poverty areas, but household gains ocurred in high poverty areas, emphasizing the difficulty of meeting multiple policy objectives with a single tool. To what degree the touted win-wins of natural climate solutions can be achieved in practice is an area in need of further exploration. In the avoided deforestation case, environmental benefits are largely driven by the presence of deforestation risk, however, in the reforestation case, effectiveness relies on whether landowners can be incentivized to make the longer-term investment in tree survival. 

<!-- ^This paragraph could be replaced with one about the factors that drive reforestation success -->

<!-- Efficient targeting of public programs is difficult when the costs or benefits to potential recipients is private information [@jack_private_2013]. This is a major consideration in the payments for reforestation case, where the opportunity cost of restoration to landowners is unknown to program administrators. The optimal contract and program design literature has sought to find ways to circumvent this issue in PES contexts. For example, @jack_private_2013 shows that an auction mechanism can generate significant cost savings by identifying users with high private benefit-to-opportunity cost ratios for tree maintenance. @jack2017 further show that auctions can effectively mitigate the risk of leakage in PES scenarios. Ultimately, auctions clearly reduce informational rents for program administrators and help to obtain cost-effective program results, but there can be substantial equity trade-offs in many circumstances [@alix-garcia_payment_2014]. Other factors such as uncertainty can influence the effectiveness of certain contract designs [@oliva_technology_2020], and understanding why low-follow through rates are common in many settings is an open area of research.  -->

In this paper, we evaluate the land cover impacts of Chile’s Native Forest Law. A key concern with evaluations of these types of programs is that apparent effectiveness may be driven by unobservable differences in participation costs, meaning that performance may be attributed to these omitted characteristics rather than participation in the program [@alix-garcia_only_2015]. From a pool of over five-hundred-thousand untreated properties, we construct a set of counterfactual properties based on a detailed set of land use and property characteristics in order to alleviate some of the concerns surrounding selection. We evaluate land cover impacts for eleven cohorts (2009–2019) using annual data from 2005–2020 and difference-in-differences regressions that are robust to general treatment effect heterogeneity.

We then analyze the Native Forest Law’s program design and the drivers of program additionality to understand whether improved environmental impacts could have been achieved and whether doing so would sacrifice program goals such as the involvement of smallholders. The program targets for both environmental and social benefits in two ways: 1) holding separate contests for smallholders and larger landowners and 2) scoring proposed projects based on pre-determined applicant and project criteria. We explore whether this approach might create tradeoffs between environmental and social development goals. Ultimately, it appears that smallholders experience marginally smaller treatment effects, but this is largely driven by pre-program land use characteristics that are likely indicative of the landowner's prior forestry experience and the property's productive potential. It may be possible to improve program performance without sacrificing smallholder involvement by targeting smallholders with certain characteristics or with prior forest management experience. The program's scoring mechanism appears to predict performance relatively well and is positively correlated with property characteristics that drive improved performance. 

This draft aims to advance the literature that addresses whether reforestation may be a viable large-scale method for removing and storing CO2 and add to the limited existing evidence on the environmental effectiveness of large-scale native reforestation programs. Between 2009 and 2019, the National Forest Corporation (CONAF) allocated approximately US $58 million to enroll more than 235 hectares of land through the Native Forest Law, making it one of the largest native forest reforestation programs in the world. As other countries begin to contemplate reforestation policies, Chile’s experience provides a valuable case study from which to draw. 

We contribute to the literature on targeting and whether there exist tradeoffs between environmental efficacy and advancement of social development goals, particularly in the case of natural climate solutions. We evaluate the Native Forest Law's targeting approaches and show that while there are tradeoffs, it may be possible to achieve greater environmental gains without the exclusion of smallholders. Further, this paper shows that pre-program land use is a major determinant of whether a property is likely to provide much additionality. 

The remainder of the paper is organized as follows. Section 2 gives the broad setting and our data sources. Section 3 presents the initial impact evaluation and overall results along with potential implications. Section 4 explores heterogeneity in program impacts based on pre-program land use and the program's targeting objectives. Section 5 concludes. 

# Chile's Native Forest Law

Chile provides an ideal setting in which to explore the potential for large-scale payments for reforestation. First, the country has experienced diverse and widespread tree cover expansion [@heilmayr_plantation-dominated_2016]. This expansion includes extensive afforestation of pine and eucalyptus plantations [@echeverria2006], natural forest regeneration in the wake of disturbance [@albornoz_nucleation-driven_2013], and active native reforestation and restoration. Second, Chile’s long history of public policies supporting tree cover expansion provides an incredibly useful natural experiment in which to measure the impacts of payments for reforestation. Chile's decree law no. 701 (DL 701) is one of the world's longest operating afforestation subsidies, but mainly promoted even-aged mococulture plantations of eucalyptus and pine that had negative effects on biodiversity and native forest cover [@heilmayr_impacts_2020]. Further, only about 3\% of subsidized plantaions were additional. 

In an attempt to encourage the recovery and protection of native forests, Chile sought to pass the Ley de Recuperación del Bosque Nativo y Fomento Forestal (Native Forest Law) as a successor to DL701 (@clapp1998). Initially expected in 1994, it became frozen in legislature before finally passing in 2008. In addition to protections for native forests, the law established an annual competition for grants to support private landowners in their efforts to restore or reforest their land using native species. Since 2009, more than $58 million have been allocated through these competitions for projects covering 235 thousand hectares. In response to concerns that large companies benefited disproportionately from the DL701 subsidies, emphasis is placed upon supporting smallholders and indigenous peoples. In particular, smallholder awards are worth 15\% more than awards in the other interested parties contest, and applications from indigenous communities are substantially more likely to receive funding.

## Data

### administrative data

We have obtained property boundaries for all rural properties in the major forested regions of Chile as of the year 2009. Data on the awarded properties are available through CONAF and reflect aspects of the property and projects such as project surface area, bonus amount, and applicant race and gender. Also included is each property's parcel indentifier, which is unique to each property within a comuna, Chile's level 3 administrative unit. We match the enrolled properties to their corresponding boundaries via this unique parcel identifier. 
Figure \@ref(fig:enrolled-map) shows the result of this process.

```{r enrolled-map, fig.pos="H", out.width = '50%', fig.cap = "This figure shows properties enrolled through the Native Forest Law contest by year of enrollment. We have since expanded the matched property boundaries to the Chile-Argentina border.", echo=FALSE}
knitr::include_graphics("figs/propertymap_updated.pdf")
```

<!-- I have obtained the names of payment recipients associated with the Native Forest Law along with the date of the payment. Using fuzzy string matching on the names of the payment recipients and the program application names, I am able to match 85.67\% of the paid names to corresponding properties. Visual confirmation ensures that the fuzzy matching produces reasonable matches.  -->

### satellite data

We use normalized difference vegetation index (NDVI) as a proxy for each property's annual level of vegetation/forest cover. To generate the outcome for each property, we compute the average maximum NDVI value of each pixel (greenest pixel) within a property for a given year. We have generated NDVI time series of this sort for each property in the regions of Maule, Araucanía, Bío-Bío, Ñuble, and Los Ríos. These regions constitute the major forest areas of Chile and the regions that contain a majority of the Native Forest Law enrollees. Generating time series for all properties in these regions allows us to match on pre-trends of the outcome variable in the matching part of the program evaluation. 

One benefit of the use of NDVI is the ability to capture both new forest cover and changes in forest quality within a single index measure. A concern with this outcome is its propensity to become saturated in high biomass regions. Given Chile's extensive native and plantation forests and the fact that many enrolled properties already have forest cover, this may limit our ability to detect small changes in vegetation/forest cover through time. 

<!-- We have recently obtained forest inventory data from Chile's Institute of Forestry (INFOR) containing plot level volumes and densities along with the relevant geocoordinates and measurement years for the above regions. Working with colleagues in Bren, we hope use these as training and validation data to generate maps of aboveground biomass in the above regions. This will allow me to generate treatment effect estimates directly in terms of carbon in aboveground biomass.  -->

Lastly, Landsat resolution (30m) land-use maps of Chile for the year 2001 generated in @heilmayr_plantation-dominated_2016 allow us to see the proportion of each property engaged in specific land uses prior to the existence of the Native Forest Law or the announcement of the annual contests. 

```{r, include = FALSE}
rolarea_covars <- data.frame(readRDS("rolarea_covars.rds"))
rolarea_df <- data.frame(readRDS("rolarea_df.rds"))
propertypaid_id <- data.frame(readRDS("propertypaid_id.rds"))
rolarea_df$geometry <- NULL
rolarea_covars$geometry <- NULL
enrolled_df <- rolarea_df %>%
  inner_join(rolarea_covars, by ="prop_ID")%>%
  mutate(forest = c_1,
         plantation = c_3,
         baresoil = c_12,+c_10,
         pasture = c_9,
         water = c_15,
         urban = c_16,
         shrub = c_5,
         timber = ifelse(rptpro_objetivo_manejo.x == "PRODUCCION MADERERA", 1, 0),
         nontimber = ifelse(rptpro_objetivo_manejo.x == "PRODUCCION NO MADERERA", 1, 0),
         ecologio = ifelse(rptpro_objetivo_manejo.x == "BOSQUE PRESERVACION Y FORMACIONES XEROFITICAS DE ALTO VALOR ECOLOGICO", 1, 0),
         reftype = ifelse(ecologio==1|reforestation2==1, 1, 0),
         female = ifelse(rptprop_sexo == "Masculino", 0, 1),
         indigenous = ifelse(rptprop_etnia == "Aymara" | rptprop_etnia == "Mapuche" | rptprop_etnia == "Otra", 1, 0),
         smallholder = ifelse(rptpro_tipo_concurso == "Otros Interesados", 0, 1))%>%
  mutate_at(vars(forest:shrub), ~replace(., is.na(.), 0))

enrolled_df$smallholder <- as.character(enrolled_df$smallholder)
pd <- position_dodge(0.25)

paid.enrolled <- enrolled_df %>%
  left_join(propertypaid_id) %>%
  mutate(paid = ifelse(is.na(paid), 0, paid))

```

# Program evaluation

## Selection, matching, and a convincing counterfactual

As is the problem with many PES impact evaluations, enrollment is non-random. Landowners choose to enroll in the program and, in theory, have an opportunity cost equal to or lower than program enrollment. It is then ill-advised to simply use unenrolled properties as the counterfactual, since unobservable factors affecting enrollment could drive changes in forest cover outcomes, not enrollment. In order to generate a more convincing counterfactual, we match properties to ones that should have more similar opportunity costs than amongst the general population. 

The covariates used for matching include property size, slope, elevation, distance to road, and proportion of the property under each of the following land-uses in 2001: native forest, plantation, pasture, shrubland, water, and bare soil. We also include the 2007 levels of NDVI for each property, which should correspond to the overall vegetation cover prior to the existence or announcement of the Native Forest Law contest. Lastly, matching on 5 years of NDVI pre-trends will help us to build confidence in the conditional common trends identification assumption that we make for the difference-in-differences estimation strategy in the next section. Matches are made with replacement based on nearest neighbor propensity scores from a logit regression. Our main strategy matches each program enrollee with two control properties, however, we also include estimates based on matching each enrolled property with one nearest neighbor as a robustness check.  

The covariates included should allow us to match properties with similar opportunity costs to enrollment. Of particular value is the ability to match on land use prior to the existence of the program. Landowners with similar levels of forest plantation, native forest, and other land uses on the property should face a similar decision about whether to enroll in a program involving native forest management. Slope and elevation tend to be highly correlated with the productive potential of the land, and distance to road provides a proxy of a property's remoteness. Table \@ref(tab:covar-bal) and Figure 1 show how covariate balance drastically improved between treatment and control properties after matching. 

```{r m-dist, fig.pos="H", out.width = '75%', fig.cap = "Covariate distributions for enrolled and non-enrolled properties before (left) and after (right) propensity score matching for key covariates", echo=FALSE}
knitr::include_graphics("figs/matched_distributions.png")
```

```{r covar-bal, fig.pos = "H", fig.cap = "Covarate balance between treated and untreated groups with and without matching. The leftmost panel is based on nearest neighbor matching with two nearest neighbors (r =2), the middle panel is based on one nearest neighbor (r=1), and the right panel is the unmatched data"}

covar_bal <- readRDS("covariate_balance.rds")
covar_bal[9, 1] <- "area (ha)"
covar_bal[10, 1] <- "dist. to road"
covar_bal[11, 1] <- "2007 NDVI"

kable(covar_bal, format = "latex", row.names = FALSE, booktabs = T, 
      caption = "Covariate balance with and without matching", 
      col.names = c("covariate", "norm. diff.", "threshold", "norm. diff.", "threshold", "norm. diff.", "threshold"), escape = TRUE) %>% 
  add_header_above(c(" "=1, "matched (r=1)"=2, "matched (r=2)"=2, "unmatched" = 2), escape = TRUE, line =FALSE, bold = TRUE)%>%
  kable_classic()

```

In this case, we need to make a conditional common trends assumption, which amounts to assuming that without enrolling in the Native Forest Law contest, enrolled properties would have continued to follow the same evolution in NDVI as matched control properties, conditioning on covariates. While fundamentally untestable, we can build confidence in this assumption by examining pre-trends of both enrolled and matched control properties. Further, the use of matching to generate properties with more comparable opportunity costs and future land use intentions should lend additional creedence to this assumption. 

One concern may be our decision to exclude rejected applicants from the control group. Given that these properties have revealed their intention to enroll in the program, it seems that they may have opportunity costs similar to program enrollees. However, the composition of the rejected applicants differs between smallholders and other interested parties depending on year, and many rejected applicants are able to reapply and be awarded in later years. This means that the composition of the rejected applicant group is relatively unstable through time. Further, it would be difficult to make claims about the differences between the smallholders and other interested parties, because the rejected group differs through time for each. We discuss the rejected applicants in more detail in the Appendix. 

## DID

In order to estimate the program impact, we use a difference-in-differences event study that is robust to general treatment effect heterogeneity. Recent papers have shown that the typical two-way fixed effects estimator may generate biased results in the presence of treatment effect heterogeneity [e.g., @goodman-bacon_did_2018; @callaway_did_2020; @dechaisemartin2020]. This could be particularly important in our case, given that there are over 150 cohort-time cells. We individually estimate the average treatment effect for each cohort-time cell, $\beta_{g,t}$, where $g$ denotes the cohort, and $t$ denotes the year. We then aggregate the $\beta_{g,t}$s into a summary measure of the overall $ATT$ based on @callaway_did_2020.

To generate the $\beta_{g,t}$s, we first subset the data to only contain observations at time $t$ and $g − 1$, from units with either $G_i = g$ or that are in the control group. For example, for the $\beta_{2019, 2019}$, we subset to only the 2019 cohort and control group for the years 2018 and 2019. Then using only the observations from this subset, we calculate $\beta_{g,t}$ using the doubly robust difference-in-differences estimator in @santanna2020. This involves first estimating a propensity score using a logit model and allows for common trends to hold only after conditioning on pre-treatment covariates. 

We use two measures of the $ATT$ in this paper. The first measure provides event study estimates. Here, within each event time window, we aggregate the $\beta_{g,t}$s with weights corresponding to group size. 

$$ ATT_{es}(e) = \sum_{g\in G} \mathbb{1}\{ g+e \leq \Tau\} P(G_i=g | G_i+e\leq \Tau)\beta_{g,g+e} $$

This is the average effect of participating in the treatment $e$ time periods after a characteristic property is enrolled in the program across all cohorts that are ever observed to have participated in the treatment for exactly $e$ time periods. The year a property enrolls in the program is denoted by $e=0$. 

Our second summary measure, $ATT_{ovr}$, provides an estimate of the overall $ATT$. 
$$ ATT_{ovr} =\frac{1}{T-t_0+1} \sum_{e=0}^{T-t_0}ATT_{es}(e)$$
, where in our case $t_0 = 2009$ and $T=2020$.

Thus, $ATT_{ovr}$ is simply an average of all event time treatment effect estimates after treatment. One potential concern about $ATT_{ovr}$ is that each $ATT_{es}(e)$ has equal weight, meaning cohorts that are treated for longer have a larger influence on the $ATT_{ovr}$ relative to their group size. In this circumstance, we view this as a benefit. In the case of forest regeneration, restoration, and reforestation, we shouldn't expect a huge "on-impact" treatment effect, but rather a steady accumulation of biomass and foliage through time. Further, the benefits of these activities are closely related to their permanence, meaning that forest cover must be sustained over time. As such, it is unclear that giving equal weight to later event time treatment effects is problematic in this context, given that those event times are the most representative of program success. Future iterations of the paper will provide alternative aggregations as well. 

## Overall program results

We first measure the impact of the program on all enrolled properties. This is the effect of being granted enrollment in the program and having the project and subsequent payment approved. Figure \@ref(fig:enrolled-dynamic) shows that the NDVI on the characteristic awarded property steadily increases through time on average relative to the control properties following treatment.

```{r enrolled-dynamic, fig.pos="H", out.width = '75%', fig.cap = "This figure shows event time treatment effects of the native forest law for all enrolled properties. The control group has been formed via nearest neighbor propensity score matching with replacement (r=2).", echo=FALSE}
knitr::include_graphics("figs/enrolled_dynamic_2r.png")
```

Figure \@ref(fig:enrolled-dynamic) also allows us to examine the plausibility of our conditional common trends assumption. We do see that pre-trends are relatively stable, lending creedence to the assumption. As discussed previously, matching on detailed land use and property characteristics allows us to compare properties that likely had similar future land use intentions and opportunity costs. Looking at Table 2, we see that the overall treatment effects ($ATT_{ovr}$) are also positive and statistically significant. 

\begin{table}[H]\centering
\caption{Overall treatment effect estimates for all enrolled properties}
\smallskip
\begin{tabular}{c c c}

\toprule
  Dependent variable: NDVI & &\\ 
\cmidrule(l){2-3} 
 & \textbf{1} & \textbf{2} \\ 
\midrule
 enrolled  &           0.00894***  &  0.00908***       \\
        &         (0.00149)  &  (0.00191)     \\ 
\midrule
 \# properties      &     6880       &     4707       \\          
match ratio        &       2       &       1    \\
\bottomrule
\addlinespace[1ex]
\multicolumn{3}{l}{\textsuperscript{***}$p<0.01$, 
  \textsuperscript{**}$p<0.05$, 
  \textsuperscript{*}$p<0.1$}
\end{tabular}
\end{table}

One potentially important thing to note is that, as seen in Figure \@ref(fig:enrolled-dynamic), the treatment effects may not have stabilized yet. It is then difficult to claim that this estimate of the $ATT$ is indicative of the total effect of the program. 

# Pre-program land use composition helps to explain treatment effect heterogeneity

The above section indicates that on average, the Native Forest Law is effective in generating vegetation and forest cover on enrolled properties. Whether or not program managers could actually improve the environmental effectiveness of the program depends on whether systematic heterogeneity in forest cover impacts can better inform the application and award process. In the context of avoided deforestation, program managers can seek to target areas with high levels of deforestation risk in order to maximize program effectiveness. This is not applicable in the reforestation case, however. Instead program managers must determine which landowners are most likely to generate new forest cover at least cost and maintain it through time. Here, we explore how heterogeneity in program impacts can provide lessons for targeting and reforestation program success. 

This section shows that program additionality varies heavily depending on the pre-program land-use of the property. Table 3 shows that properties with a higher proportion of their property as grassland see lower treament effects, while properties with higher proportions of plantation forest have higher treatment effects. While higher levels of native forest cover are associated with lower treatment effects, it is not significant. 

\begin{table}[H]\centering
\caption{Treatment effect heterogeneity based on pre-program land uses}
\smallskip
\begin{tabular}{c c c c}

\toprule
   Dependent variable: NDVI & & &\\ 
\cmidrule(l){2-4} 
 & \textbf{1} & \textbf{2} & \textbf{3} \\ 
\midrule
enrolled                       &      0.00804***   &    0.00936***   &      0.001344  \\
                            &      (0.00196)       &      (0.00156)       &      (0.00151) \\ 
                       
enrolled x forest            &              -0.00611 &     &\\
                          &              (0.00403)      &      &\\
                       
enrolled x pasture           & &          -0.01291*** &         \\
                          & &          (0.00450)    &         \\
                       
enrolled x plantation        & & &        0.04161***\\
                          & & &      (0.01162)\\
                       
\midrule
 \# properties                     &     6880    &     6880   & 6880\\          
match ratio            &    2       &       2    & 2 \\
\bottomrule
\addlinespace[1ex]
\multicolumn{3}{l}{\textsuperscript{***}$p<0.01$, 
  \textsuperscript{**}$p<0.05$, 
  \textsuperscript{*}$p<0.1$}
\end{tabular}
\end{table}

Figure \@ref(fig:landuse) in the Appendix shows that in more recent cohorts, the average enrolled property had a higher pre-program proportion of pasture and less native forest. These findings, therefore, may raise concerns about the expected performance of more recent cohorts, given that higher pre-program proportions of pasture and native forest are associated with lower treatment effects. In addition, Figure \@ref(fig:landuse-contest) shows that smallholders generally have a larger proportion of their property with pasture and less with plantation forest than larger properties. This raises doubts about whether program administrators could improve the program's evironmental effectiveness without sacrificing smallholder participation. These findings do make sense. Landowners with plantation forest are likely to have more experience and the technical skills needed to manage a forest restoration or management project. Properties with more grassland may be less well suited to generate high amounts of additional forest cover, and these landowners may have, on average, less experience with forest management. 


# The program's targeting strategies

The program sought to balance efficiency and equity outcomes by targeting smallholders and indigenous communities. The Native Forest Law targeted in two ways: 1) holding separate contests for smallholders and larger properties and 2) the scoring mechanism. If payments were less additional for smallholders or indigenous peoples, the program could have foregone carbon gains in exchange for this redistribution. Determining whether improved environmental effectiveness can be achieved without sacrificing the engagement of these groups depends on whether there exists systematic heterogeneity in impacts. If effectiveness could be improved without sacrificing smallholder engagement, what types of smallholders would be the best targets? How effective is the scoring mechanism at gauging social development or environmental gains?

## smallholder vs. other interested party performances

We compare the overall performances of smallholders and other interested parties. Columns 1 and 2 of Table 4 show that when compared separately, other interested parties outperform smallholders, although smallholders still see a positive effect from enrollment. Column 3 shows that when compared together, there is no meaningful difference between the two groups. Given that smallholders are paid 15\% more for the same activities, enrolling smallholders is likely less cost effective than enrolling larger properties. 

One consideration that may affect the performace of each group is their propensity to have prior forestry experience. Smallholders on average have less of their property engaged in plantation forestry and more of their property under pasture prior to the existence of the native forest law (Figure \@ref(fig:landuse-contest)). In light of the results above, this may indicate that they are less well suited to generate new forest cover. 

\begin{table}[H]\centering
\caption{smallholder vs. other interested party treatment effects}
\smallskip
\begin{tabular}{c c c c}

\toprule
   Dependent variable: NDVI & & & \\ 
\cmidrule(l){2-4} 
 & \textbf{1} & \textbf{2} & \textbf{3}  \\ 
\midrule
enrolled                       &      0.00761***   &    0.01004***   &      0.00581***   \\
                            &      (0.00180)  &  (0.00308)      &      (0.00178)  \\ 
                            
enrolled x smallholder        &                  &                 &       0.00031          \\
                          &                  &                 &        (0.00250)             \\                       
\midrule
 sample               & \textbf{smallholders} & \textbf{other interested parties} & \textbf{full sample} \\
 \# properties         &     4576    &     2304   & 6880\\          
match ratio            &    2       &       2    & 2  \\
\bottomrule
\addlinespace[1ex]
\multicolumn{3}{l}{\textsuperscript{***}$p<0.01$, 
  \textsuperscript{**}$p<0.05$, 
  \textsuperscript{*}$p<0.1$}
\end{tabular}
\end{table}

## Impact heterogeneity by score bin

Here is an instance in which we benefit from few properties being rejected in the earlier years of the program, as we are able to see the performance of projects with both low and high scores. This helps us to understand how the scoring mechanism might be able to predict program performance. Table 5 displays the treatment effects across each quartile of project score. 

These results indicate that performance is likely increasing in score. Projects with scores in the first quartile are not generating much additional forest cover or vegetation at all, while properties whose applications received high scores see relatively large treatment effects. Figure \@ref(fig:score-quart) shows that projects with lower scores tend to have lower levels of pre-program plantation forest and higher levels of pasture. The fact that lower scoring projects experience lower program impacts is therefore not surprising. Future work will need to examine the application characteristics and their relationship to the score. This will help to get at cost-effectiveness across scores. 

\begin{table}[H]\centering
\caption{Treatment effects by score quartile. Note that N differs across quantiles due to the fact that matching is done with replacement. }
\smallskip
\begin{tabular}{c c c c c}

\toprule
   Dependent variable: NDVI & & & &\\ 
\cmidrule(l){2-5} 
 & \textbf{1st quartile} & \textbf{2nd quartile} & \textbf{3rd quartile} & \textbf{4th quartile} \\ 
\midrule
enrolled                       &      -0.00052   &    0.00843***   &      0.01336***   & 0.01324*** \\
                            &      (0.00300)  &  (0.00288)      &      (0.00352)   & (0.00359)  \\ 
                       
\midrule
 \# properties         &     1760    &     1737   & 1721 & 1662\\          
match ratio            &    2       &       2    & 2  & 2\\
\bottomrule
\addlinespace[1ex]
\multicolumn{3}{l}{\textsuperscript{***}$p<0.01$, 
  \textsuperscript{**}$p<0.05$, 
  \textsuperscript{*}$p<0.1$}
\end{tabular}
\end{table}

## Discussion

Prominent initiatives such as the Bonn Challenge, Trillion Trees Initiative, and UN Decade on Ecosystem Restoration hope to address the intertwined challenges of rural poverty, climate change and biodiversity loss through large-scale afforestation and reforestation. Initial national plans indicate that many countries will follow Chile’s model for tree cover expansion, relying heavily upon subsidies and plantation forests to achieve their commitments [@heilmayr_impacts_2020]. In light of the fact that this model may have negative impacts on native forest extent, biodiversity, and other outcomes, payments for native reforestation may provide a more sustainable and socially optimal path forward. This paper shows that payments for native reforestation may be a viable policy to increase carbon removals from the atmosphere for many countries. Further, this may lead to increased additionality if alternative policies simply subsidize plantation forests that would have been planted anyways. While the cost per ton of removed carbon associated with this strategy is unclear, Native Forest Law payments led to increased forest cover for both smallholders and larger landowners. 

In order to maximize program impacts and ensure participation of smallholders and other marginalized groups, these payment for reforestation plans must carefully consider which landowners are likely to ensure tree survivorship and complete their reforestation projects. We find that properties that had engaged in plantation forestry prior to the existence of the Native forest Law were most likely to generate additional forest cover, suggesting that prior forestry experience or technical support is likely to be key for landowners' project success. While it is not clear that smallholders performed worse than other interested parties, it is the case that smallholders on average had less pre-program plantation forest on their property. This may imply that smallholders are in particular need of additional support if they are to successfully participate in the reforestation targets. Ultimately, our results reinforce that well designed payments for reforestation can lead to increased forest cover while maintaining environmental and social safeguards such as the protection of native forest and the involvement of smallholders. 

# References

<div id="refs"></div>

# Appendix 

## Comparing enrolled smallholders and other interested parties on observables 

Table 7: comparing enrolled smallholders vs. other interested parties on observables

```{r, include = FALSE}
score <- t.test(rptpro_puntaje ~ smallholder, data = enrolled_df)
payment <- t.test(rptpre_monto_total ~ smallholder, data = enrolled_df)
area <- t.test(rptpre_superficie_bonificada ~ smallholder, data = enrolled_df)
elev <- t.test(elev ~ smallholder, data = enrolled_df)
size <- t.test(area_ha ~ smallholder, data = enrolled_df)
slope <- t.test(slope ~ smallholder, data = enrolled_df)
propawarded <- t.test(rptpre_superficie_bonificada/area_ha ~ smallholder, data = enrolled_df)
awdperha <- t.test(rptpre_monto_total/rptpre_superficie_bonificada ~ smallholder, data = enrolled_df)

covar <- c("score", "award (UTM)", "bonus area (ha)", "property size (ha)", "slope", "elevation" , "UTM per ha", "proportion of property subsidized")
smallholder <- c(score$estimate[2], payment$estimate[2], area$estimate[2], size$estimate[2], slope$estimate[2], elev$estimate[2], awdperha$estimate[2], propawarded$estimate[2])
other <- c(score$estimate[1], payment$estimate[1],  area$estimate[1], size$estimate[1],   slope$estimate[1], elev$estimate[1], awdperha$estimate[1], propawarded$estimate[1])
p_value <-  c(score$p.value, payment$p.value, area$p.value, size$p.value,  slope$p.value, elev$p.value, awdperha$p.value, propawarded$p.value)

contestdiff_df <- data.frame(covar, smallholder, other, p_value)  

```

```{r contest-covars, fig.pos="H"}

kable(contestdiff_df, format = "latex", row.names = FALSE, booktabs = T, col.names = c("covariate", "smallholder mean", "other interested mean", "p-value"), align='l')%>%
  row_spec(0,bold=TRUE)

```


```{r, include = FALSE}
rolarea_covars <- data.frame(readRDS("rolarea_covars.rds"))
rolarea_df <- data.frame(readRDS("rolarea_df.rds"))
propertypaid_id <- data.frame(readRDS("propertypaid_id.rds"))
rolarea_df$geometry <- NULL
rolarea_covars$geometry <- NULL
enrolled_df <- rolarea_df %>%
  inner_join(rolarea_covars, by ="prop_ID")%>%
  mutate(forest = c_1,
         plantation = c_3,
         baresoil = c_12,+c_10,
         pasture = c_9,
         water = c_15,
         urban = c_16,
         shrub = c_5,
         timber = ifelse(rptpro_objetivo_manejo.x == "PRODUCCION MADERERA", 1, 0),
         nontimber = ifelse(rptpro_objetivo_manejo.x == "PRODUCCION NO MADERERA", 1, 0),
         ecologio = ifelse(rptpro_objetivo_manejo.x == "BOSQUE PRESERVACION Y FORMACIONES XEROFITICAS DE ALTO VALOR ECOLOGICO", 1, 0),
         reftype = ifelse(ecologio==1|reforestation2==1, 1, 0),
         female = ifelse(rptprop_sexo == "Masculino", 0, 1),
         indigenous = ifelse(rptprop_etnia == "Aymara" | rptprop_etnia == "Mapuche" | rptprop_etnia == "Otra", 1, 0),
         smallholder = ifelse(rptpro_tipo_concurso == "Otros Interesados", 0, 1))%>%
  mutate_at(vars(forest:shrub), ~replace(., is.na(.), 0))

enrolled_df$smallholder <- as.character(enrolled_df$smallholder)
pd <- position_dodge(0.25)

paid.enrolled <- enrolled_df %>%
  left_join(propertypaid_id) %>%
  mutate(paid = ifelse(is.na(paid), 0, paid))

```

## The program's targeting strategies and heterogeneity in land use composition

The program sought to balance efficiency and equity outcomes by targeting smallholders and indigenous communities. The Native Forest Law targeted in two ways: 1) holding separate contests for smallholders and larger properties and 2) the scoring mechanism. If payments were less additional for smallholders or indigenous peoples, the program could have foregone carbon gains in exchange for this redistribution. Determining whether improved environmental effectiveness can be achieved without sacrificing the engagement of these groups depends on whether there exists systematic heterogeneity in impacts. If effectiveness could be improved without sacrificing smallholder engagement, what types of smallholders would be the best targets? How effective is the scoring mechanism at gauging social development or environmental gains? This is closer to the current draft. 

Pre-program land use is likely to be a significant driver of this heterogeneity. Recent studies have found that a major barrier to reforestation success is a lack of technical skills and prior experience [e.g., @powlen_identifying_2019]. Further, landowners with high initial participation costs are less likely to engage in reforestation. These aspects of reforestation mean that pre-program land use characteristics likely play a major role in shaping a landowner's forest management success. In this section, we use Landsat resolution land use maps of Chile in 2001 to explore the pre-program land use composition of properties that eventually enrolled in the program. We explore the proportion of each property under each of the following land uses in 2001: native forest, plantation forest, and pasture. 

Thinking about the pre-program land uses of eventually enrolled properties raises some interesting questions about the additionality of the policy. If properties with high levels of native forest cover are receiving subsidies through the Native Forest Law contest, it is possible that additionality will be low. Landowners who maintain a significant amount of native forest may already undertake these activities in the absence of the payments. These properties may be able to provide native forest cover or forest quality gains at a lower cost, meaning they are inefficiently being paid above their opportunity cost for the projects. Properties with plantation forestry may be using funds from the Native Forest Law to substitute toward native forest. While the carbon additionality may be low in this case, co-benefits such as biodiversity gains and habitat connectivity would likely be had. If these landowners are extending forest cover on the property and doing so using native species, these properties may provide significant gains, because they have the experience and resources to ensure survival of trees and forest. If properties with high amounts of pasture move away from livestock grazing or even enrich the grasslands that exist on the property, carbon additionality could be high. These could conceivably be properties that face higher costs to initiate forest management activities that the landowner does not have much experience with. 

Given that pre-program land use is likely to be a significant determinant of additionality and the fact that the directions of these signs may be unclear, this has important repercussions for the program administrator from a targeting perspective.

### land use composition by application score

```{r, include =FALSE}
test <- within(enrolled_df, quartile <- as.integer(cut(rptpro_puntaje, quantile(rptpro_puntaje, probs=0:4/4), include.lowest=TRUE)))

q_forest <- ggplot(summarySE(test, measurevar="forest", groupvars=c("quartile"), na.rm = TRUE),
  aes(x=quartile, y=forest)) + 
    geom_errorbar(aes(ymin=forest-se, ymax=forest+se), width=.25, position=pd, color = "darkgreen") +
    geom_line(position=pd, color = "darkgreen") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  ylab("proportion forest")+ggtitle("native forest")

q_plantation <- ggplot(summarySE(test, measurevar="plantation", 
                                 groupvars=c("quartile")#, "contest")
                                 , na.rm = TRUE),
  aes(x=quartile, y=plantation)) + 
    geom_errorbar(aes(ymin=plantation-se, ymax=plantation+se), width=.25, position=pd, color = "mediumseagreen") +
    geom_line(position=pd, color = "mediumseagreen") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  ylab("proportion plantation")+ggtitle("plantation forest")
  
  
q_past <- ggplot(summarySE(test, measurevar="pasture", groupvars=c("quartile"), na.rm = TRUE),
  aes(x=quartile, y=pasture)) + 
    geom_errorbar(aes(ymin=pasture-se, ymax=pasture+se), width=.25, position=pd, color = "goldenrod4") +
    geom_line(position=pd, color = "goldenrod4") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  ylab("proportion grassland")+ggtitle("pasture and grassland")

```

A large literature shows that targeting on observables could improve environmental outcomes of public programs [e.g., @mason_2013; @cho2019]. The Native Forest Law made a significant effort to engage smallholders, indigenous groups, and women, possibly conceding some environmental gains. In order to balance this trade-off, the program assigns each application a score based on applicant, property, and project characterisitcs. Smaller properties and properties in indigenous communities get additional points, but other applicants may be able to make up for some shortcomings by simply enrolling more land in the program or taking on higher value activities. It is unclear that this scoring mechanism makes efficient tradeoffs between equity and the environment. We have the unusual ability to match a specific property with its score, and thus, explore these tradeoffs. 

Figure \@ref(fig:score-quart) shows how pre-program land use varies by score quartile. The left panel shows how the average proportion of native forest varies across score quartiles. The middle and right panels show the same for plantation and pasture, respectively. While the average proportion of a property with native forest doesn't vary much across score quartiles, proportions of plantation forest and grassland are clearly associated with score. Score quartile and the proportion of the property with plantation forest are positively correlated, while score quartile and the proportion of the property with pasture are negatively correlated. If these pre-program land uses are determinants of how effective a landowner is at implementing the reforestation project, the score is likely a good predictor of environmental performance. If so, it may be interesting for future work to explore how well the score correlates with social metrics such as communal poverty and applicant race or gender. 

```{r score-quart, fig.pos="H", fig.show="hold", out.width="32.5%", fig.cap = "Left: average pre-program proportion of property classified as native forest by application score quartile; Middle: average pre-program proportion of property classified as plantation forest by application score quartile; Right: average pre-program proportion of property classified as grasslands/pasture by application score quartile"}
q_forest
q_plantation
q_past

```

### land use composition by cohort

Figure \@ref(fig:landuse) shows the composition of cohorts' land use with regards to each land class. The left panel shows that early cohorts had higher levels of native forest than later enrollees. The middle panel shows that the proportion of the average property with plantation forestry hasn't clearly changed over time. Lastly, the right panel shows that later cohorts had higher levels of pasture on their property on average.  

```{r , include = FALSE}
enrolled_df$contest <- ifelse(enrolled_df$smallholder==1, "smallholder", "other interested parties")

p_forest <- ggplot(summarySE(enrolled_df, measurevar="forest", groupvars=c("first.treat"), na.rm = TRUE), 
       aes(x=first.treat, y=forest)
       ) + 
    geom_errorbar(aes(ymin=forest-se, ymax=forest+se), width=.1, position=pd, color = "darkgreen") +
    geom_line(position=pd, color = "darkgreen") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion forest")+ggtitle("native forest")

p_plantation <- ggplot(summarySE(enrolled_df, measurevar="plantation", groupvars=c("first.treat"), na.rm = TRUE), 
       aes(x=first.treat, y=plantation)) + 
    geom_errorbar(aes(ymin=plantation-se, ymax=plantation+se), width=.1, position=pd, color = "mediumseagreen") +
    geom_line(position=pd, color = "mediumseagreen") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion plantation")+ggtitle("plantation forest")

p_pasture <- ggplot(summarySE(enrolled_df, measurevar="pasture", groupvars=c("first.treat"), na.rm = TRUE), 
       aes(x=first.treat, y=pasture)) + 
    geom_errorbar(aes(ymin=pasture-se, ymax=pasture+se), width=.1, position=pd, color = "goldenrod4") +
    geom_line(position=pd, color = "goldenrod4") +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion grasslands")+ggtitle("pasture and grasslands")

p_shrub <- ggplot(summarySE(enrolled_df, measurevar="shrub", groupvars=c("first.treat","contest"), na.rm = TRUE), 
       aes(x=first.treat, y=shrub, colour=contest)) + 
    geom_errorbar(aes(ymin=shrub-se, ymax=shrub+se), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion shrub")

NFL_df <- readRDS("NFL_df.rds")%>%
  mutate(ecologio = ifelse(rptpro_objetivo_manejo.x == "BOSQUE PRESERVACION Y FORMACIONES XEROFITICAS DE ALTO VALOR ECOLOGICO", 1, 0))

p_ref <- ggplot(summarySE(NFL_df, measurevar="reforestation2", groupvars=c("first.treat"), na.rm = TRUE), 
       aes(x=first.treat, y=reforestation2)) + 
    geom_errorbar(aes(ymin=reforestation2-se, ymax=reforestation2+se), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion planting")

p_eco <- ggplot(summarySE(NFL_df, measurevar="ecologio", groupvars=c("first.treat"), na.rm = TRUE), 
       aes(x=first.treat, y=ecologio)) + 
    geom_errorbar(aes(ymin=ecologio-se, ymax=ecologio+se), width=.1, position=pd) +
    geom_line(position=pd) +
    geom_point(position=pd, size=3, shape=21, fill="white")+
  xlab("cohort")+
  ylab("proportion ecologically valuable")



```


```{r landuse, fig.pos="H", fig.show="hold", out.width="32.5%", fig.cap = "Left: average pre-program proportion of property classified as native forest by cohort; Middle: average pre-program proportion of property classified as plantation forest by cohort; Right: average pre-program proportion of property classified as grasslands/pasture by cohort"}
p_forest
p_plantation
p_pasture
#p_shrub
```

Given the trends we see above with respect to the properties that are enrolling in the program, additionality could either decrease or increase through time depending on how pre-program land use drives treatment effect heterogeneity. For example, if properties with high levels of grassland see low additionality, the program may see declining returns over time, as these types of properties are beginning to enroll at higher rates. 

### land use composition by contest

```{r , include = FALSE}

contest_forest <- ggplot(summarySE(enrolled_df, measurevar="forest", groupvars=c("contest"), na.rm = TRUE), 
       aes(x=contest, y=forest, fill=c("firebrick4", "green4"))
       ) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=forest-se, ymax=forest+se), width=.25, position=pd) +
  xlab("contest")+
  ylab("proportion of property with native forest")+ggtitle("native forest")+theme(legend.position = "none")

contest_plantation <- ggplot(summarySE(enrolled_df, measurevar="plantation", groupvars=c("contest"), na.rm = TRUE), 
       aes(x=contest, y=plantation, fill=c("firebrick4", "green4"))
       ) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=plantation-se, ymax=plantation+se), width=.25, position=pd) +
  xlab("contest")+
  ylab("proportion of property with plantation forest")+ggtitle("plantation forest")+theme(legend.position = "none")

contest_pasture <- ggplot(summarySE(enrolled_df, measurevar="pasture", groupvars=c("contest"), na.rm = TRUE), 
       aes(x=contest, y=pasture, fill=c("firebrick4", "green4"))
       ) + 
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(ymin=pasture-se, ymax=pasture+se), width=.25, position=pd) +
  xlab("contest")+
  ylab("proportion of property with pasture")+ggtitle("pasture and grassland")+theme(legend.position = "none")


```

Figure \@ref(fig:landuse-contest) shows how pre-program land use composition varies between properties in the smallholder vs. other interested party contest. We see that the average property's land use composition in the smallholder contest differs from that of the average other interested party's across all three land use types. We see that on average, smallholders have a higher proportion of their property with pasture. Meanwhile, other interested parties have a higher proportion of their property with both native and plantation forest, on average.  

```{r landuse-contest, fig.pos="H", fig.show="hold", out.width="32.5%", fig.cap = "Left: average pre-program proportion of property classified as native forest by contest type; Middle: average pre-program proportion of property classified as plantation forest by contest type; Right: average pre-program proportion of property classified as grasslands/pasture by contest type"}
contest_forest
contest_plantation
contest_pasture
```

There may have implications for the desired social development and evironmental win-wins. Smallholders and other interested parties on average have different pre-program land uses, of which the plantation forest and grassland differences are fairly large. If pre-program land use is a good predicitor of heterogeneity in treatment effects, this may mean that the program could have difficulties improving environmental outcomes without sacrificing the social development goals. For example, if properties with significant pre-program levels of plantation forest (indicative of prior forest management experience) see high levels of additionality, the awarding of smallholders instead of additional larger properties may reduce overall program impact. 


## Rejected applicants

During the annual Native Forest Law contest, applicants submit a management plan detailing the specifics of the project to be considered for an award. Judges score each application based on a number of criteria including the size of the property, project extent, specific activities to be performed, and the cost of the project. After scores are tallied, awards are dispersed in order of project score. Awards are given to the smallholder contest first, and subsequently to the other interested party contest. Thus, in years when the contest's funds run out, other interested parties generally go unfunded. In years in which the contest does not exceed the funding theshold for both groups, a second smallholder-only contest is held for any additional project applicants. These contests generate unawarded smallholders. Projects can become rejected either by scoring below the threshold that receives funding or because of unapproved proposed activities in the application itself. Thus there are two ways to get rejected. 

Figure \@ref(fig:allreject-hist) shows the distribution of rejected applicants by contest across different contest years. One thing to note is that many of the rejected applicants are able to adjust their application, reapply, and enroll in subsequent years. 

```{r allreject-hist, fig.pos="H", out.width = '75%', fig.cap = "This histogram shows the number of rejected applicants by year across contest types", echo=FALSE}
knitr::include_graphics("figs/rejected_hist.png")
```

In order to understand whether the enrolled set of properties differs from the full set of applicants, We compare the two groups based on a set of covariates below. (still in progress)

Because so few projects went unawarded in the early years of the program, program officials awarded projects that might not have been awarded in later years. This has pros and cons with regards to our program evaluation.  